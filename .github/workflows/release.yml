name: Release

on:
  push:
    branches: [main]

permissions: {}

jobs:
  release:
    name: Release
    uses: equinor/ops-actions/.github/workflows/release-please.yml@v9.26.1
    with:
      release_type: python
    permissions:
      contents: write
      issues: write
      pull-requests: write

  publish:
    name: Publish
    needs: release
    if: needs.release.outputs.release_created
    uses: ./.github/workflows/publish.yml
    permissions:
      contents: read
      id-token: write
